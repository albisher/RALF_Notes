**Tags:** #world-generation, #procedural-worlds, #box-system, #dependency-management
**Created:** 2026-01-13
**Type:** code-notes

# world_type_box_selector

## Summary

```
Manages selection and ordering of procedural world enhancement boxes based on world type.
```

## Details

> This `WorldTypeBoxSelector` class dynamically determines which procedural boxes (e.g., erosion, noise generation) should run for a given world type (e.g., planet, galaxy) and enforces execution order to ensure logical dependencies. It uses a predefined mapping (`box_mapping`) to associate world types with relevant boxes, then resolves execution order via `_get_execution_order()` to prioritize foundational steps (e.g., noise → terrain → shading) and optional enhancements (e.g., fractal edges for planets).

## Key Functions

### ``WorldTypeBoxSelector(Box)``

Core class initializing box mappings and dependencies.

### ``execute(input_data)``

Orchestrates box selection and ordering based on input world type.

### ``_get_execution_order(boxes, world_type)``

Determines execution sequence (e.g., noise → erosion → shading).

### ``_get_optional_boxes(world_type)``

Returns optional enhancements (e.g., `FractalEdge` for planets).

## Usage

1. Instantiate `WorldTypeBoxSelector`.
2. Call `execute()` with input data containing `operation="get_boxes"` and `world_type` (e.g., `"planet"`).
3. Retrieve `boxes` and `execution_order` for the selected world type.

## Dependencies

> ``boxes.core.box_interface` (Box`
> `BoxInput`
> `BoxOutput)`
> ``typing` (Dict`
> `List`
> `Set)`

## Related

- [[world-generation-system]]
- [[procedural-terrain-modules]]

>[!INFO] Dependency Handling
> Boxes like `HydraulicErosion` depend on terrain heightmaps generated by `SimplexNoise` or `TectonicPlateSimulation`. Execution order enforces this to avoid errors.

>[!WARNING] Fallback Behavior
> If `world_type` is invalid, the selector defaults to an empty list, but metadata includes optional enhancements (e.g., `FractalEdge` for planets).
