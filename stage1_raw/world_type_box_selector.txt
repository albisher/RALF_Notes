### TAGS
#world-generation
#procedural-worlds
#box-system
#dependency-management

### TYPE
code-notes

### SUMMARY
Manages selection and ordering of procedural world enhancement boxes based on world type.

### DETAILS
This `WorldTypeBoxSelector` class dynamically determines which procedural boxes (e.g., erosion, noise generation) should run for a given world type (e.g., planet, galaxy) and enforces execution order to ensure logical dependencies. It uses a predefined mapping (`box_mapping`) to associate world types with relevant boxes, then resolves execution order via `_get_execution_order()` to prioritize foundational steps (e.g., noise → terrain → shading) and optional enhancements (e.g., fractal edges for planets).

### KEY_FUNCTIONS
- **`WorldTypeBoxSelector(Box)`**: Core class initializing box mappings and dependencies.
- **`execute(input_data)`**: Orchestrates box selection and ordering based on input world type.
- **`_get_execution_order(boxes, world_type)`**: Determines execution sequence (e.g., noise → erosion → shading).
- **`_get_optional_boxes(world_type)`**: Returns optional enhancements (e.g., `FractalEdge` for planets).

### DEPENDENCIES
`boxes.core.box_interface` (Box, BoxInput, BoxOutput), `typing` (Dict, List, Set)

### USAGE
1. Instantiate `WorldTypeBoxSelector`.
2. Call `execute()` with input data containing `operation="get_boxes"` and `world_type` (e.g., `"planet"`).
3. Retrieve `boxes` and `execution_order` for the selected world type.

### RELATED
[[world-generation-system]], [[procedural-terrain-modules]]

### CALLOUTS
>[!INFO]- Dependency Handling
> Boxes like `HydraulicErosion` depend on terrain heightmaps generated by `SimplexNoise` or `TectonicPlateSimulation`. Execution order enforces this to avoid errors.
>[!WARNING]- Fallback Behavior
> If `world_type` is invalid, the selector defaults to an empty list, but metadata includes optional enhancements (e.g., `FractalEdge` for planets).